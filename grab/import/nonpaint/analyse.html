
<body>
  <div></div>
  <script>
    (async function start(){
      let list = await fetch('list.json').then( response => response.json() );
      let prijzen = [];//await fetch('prijzen.json').then( response => response.json() );
      i=0;
      for (var n in list) {
        // n = "/creemers-compressor-type-387-90-387-90x-kopen.html";
        // console.log(n);
        // if (i++>10) continue;
        var n1 = 'pages' + n + '.json';
        let data = await fetch(n1).then( response => response.text() );
        if (data[0] === '{') {
          data = JSON.parse(data);
          console.log(n1, data);
          var div = document.querySelector('div');
          div.innerHTML = data.product;
          prijzen.push({
            title: div.querySelector('bdi').innerText,
            listPrice: div.querySelector('.ty-list-price') ? Array.from(div.querySelectorAll('.ty-list-price')).pop().innerText : null,
            price: div.querySelector('.ty-price-num') ? Array.from(div.querySelectorAll('.ty-price-num')).pop().innerText : null,
            artnr: div.querySelector('.ty-control-group__item') ? Array.from(div.querySelectorAll('.ty-control-group__item')).shift().innerText : null,
            img: data.img.filter(h => h.match(/thumbnails/))
          })
          // console.log(prijzen);

        }
        // return;
        // let data = await fetch(n1).then( response => console.log(response) );
      }
      await fetch("import.php?data=prijzen", {
        method: 'POST', // *GET, POST, PUT, DELETE, etc.
        mode: 'cors', // no-cors, *cors, same-origin
        cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
        credentials: 'same-origin', // include, *same-origin, omit
        redirect: 'follow', // manual, *follow, error
        referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
        body: JSON.stringify(prijzen, null, 2) // body data type must match "Content-Type" header
      })
      console.log(prijzen);
    })()
    // let list = await fetch(basepath + '/list.json').then( response => response.json() );

  </script>
</body>
